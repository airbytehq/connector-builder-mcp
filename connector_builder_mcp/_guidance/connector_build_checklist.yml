# Connector Builder Development Checklist
#
# This checklist guides you through the process of building a declarative
# (yaml) source connector using the Connector Builder MCP Server.
#
# Steps marked with "ðŸ“" have outputs which should be shared with your user,
# or in a log file if no user is available.

title: "Connector Builder Development Checklist"

sections:
  - name: "Research Phase"
    description: >
      These steps ensure you understand roughly the work to do before diving in.
    tasks:
      - id: "locate-api-docs"
        description: "ðŸ“ Locate API reference docs using online search."
      
      - id: "identify-auth-methods"
        description: >
          ðŸ“ Identify required authentication methods. If multiple auth methods
          are available, decide which to build first.
      
      - id: "check-advanced-features"
        description: >
          If the user or the API itself appear to require advanced features,
          check the docs tool to understand how those features might be
          implemented before you start.

  - name: "Prerequisites"
    description: >
      These prereq steps should be performed before you start work - so you can
      leave the user alone while you work, and so that you won't be blocked
      waiting for more info after you start.
    tasks:
      - id: "enumerate-streams"
        description: >
          ðŸ“ **Enumerate all available streams first**: Before beginning work on
          any stream, research the API documentation to identify and list ALL
          available streams/endpoints. Share this complete list with your user
          (or the message thread) so they can provide guidance on priorities or
          exclusions.
      
      - id: "request-dotenv-file"
        description: >
          If you do need secrets for authentication, and if user is able to
          create a .env file for you, ask them to provide you a path to the file.
      
      - id: "populate-secrets"
        description: >
          Use your tools to populate required variables to your dotenv file, then
          let the user enter them, then use your tools to verify they are set.
          (You will pass the dotenv file to other tools.)
      
      - id: "secrets-security"
        description: "**Important**: Secrets should not be sent directly to or through the LLM."
      
      - id: "confirm-stream-list"
        description: >
          ðŸ“ After enumerating streams, ask the user to confirm the list before
          you start. They can: (1) optionally suggest what the 'first stream'
          should be, or (2) inform you about specific streams they'd like you to
          ignore.

  - name: "First Stream Implementation"
    description: >
      Follow steps for one stream at a time. Lessons learned from one stream are
      generally applicable to subsequent streams. Moving in small steps reduces
      wasted efforts and prevents hard-to-diagnose issues.
    tasks:
      - id: "validate-auth"
        description: >
          Validate that authentication works for the stream, without pagination,
          and that you can see records.
      
      - id: "add-pagination"
        description: "Add pagination next. (See steps below.)"
      
      - id: "handle-advanced-topics"
        description: >
          If other advanced topics are needed, such as custom error handling,
          address these issues for each stream as needed.

  - name: "Pagination Implementation"
    tasks:
      - id: "add-pagination-logic"
        description: "Add pagination logic after working stream is established."
      
      - id: "test-pagination"
        description: "Confirm you can read a few pages."
      
      - id: "verify-stream-end"
        description: |
          Confirm you can reach the end of the stream and that stream counts are not suspect.
          - Use a suitably high record limit to get a total record count, while keeping context window manageable by opting not to returning records data or raw responses.
          - Counts are suspect if they are an even multiple of 10 or 25, or if they are an even multiple of the page size.
          - If counts are suspect, you can sometimes get helpful info from raw responses data, inspecting the headers and returned content body for clues.
      
      - id: "record-counts"
        description: >
          ðŸ“ Record the total records count for each stream, as you go. This is
          information the user will want to audit when the connector is complete.

    notes:
      - >
        **Important**: When streaming to end of stream to get record counts,
        disable records and raw responses to avoid overloading the LLM context
        window.

  - name: "Additional Streams"
    tasks:
      - id: "add-streams-sequentially"
        description: "Only add additional streams after first stream is fully validated."
      
      - id: "test-each-stream"
        description: >
          Test each new stream individually before proceeding, repeat until all
          streams are complete.
      
      - id: "verify-completeness"
        description: >
          ðŸ“ Double-check the list of completed streams with the list of planned
          streams (if available) or against your API docs. If you've omitted any
          streams, consider if they should be added. Otherwise document what was
          excluded as well as what was included.
      
      - id: "smoke-test"
        description: >
          ðŸ“ If performance will permit, run a full 'smoke test' operation on all
          streams, validating record counts and sharing the final counts with your
          user.

  - name: "Final Validation"
    tasks:
      - id: "individual-tests"
        description: "All streams pass individual tests."
      
      - id: "smoke-test-validation"
        description: "Smoke test extracts expected total records."
      
      - id: "verify-counts"
        description: "No record counts are suspicious multiples."
      
      - id: "validate-schema"
        description: >
          Use validate manifest tool to confirm JSON schema is correct.
      
      - id: "complete-documentation"
        description: "Documentation is complete."

rules:
  - "Custom Python components are not supported (for security reasons)."
  - "All MCP tools support receiving .env file path - please pass it without parsing secrets yourself."
  - "Call connector builder docs tool for specific component topics as needed."
  - "YAML anchors are not supported, although other means are available, such as ref pointers."
  - "The connector spec should be included in the manifest, not as a separate file."
  - "If manifest validation fails, review the errors and relevant documentation and then attempt to resolve the errors."
  - "For reading manifest content, prefer using the 'session_manifest_yaml_contents' MCP resource instead of the get_session_manifest_text tool for better performance and caching. The resource URI format is '<MCP_SERVER_NAME>://session/manifest' where server_name matches your MCP configuration."

guidance:
  - "For detailed guidance on specific components, use the connector builder docs tool. If called with no inputs, it will provide you an index of all available topics."
